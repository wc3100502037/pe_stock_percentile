# 股票估值百分位分析工具

## 项目概述

本项目是一个基于 Python 的股票估值分析工具，主要用于计算和展示个股的 PE（市盈率）和 PB（市净率）百分位。通过图形化界面，用户可以方便地查看股票在指定时间段内的估值水平，辅助投资决策。

## 技术栈

- **Python 3.x**
- **GUI 框架**: Tkinter + tkcalendar
- **数据可视化**: Matplotlib
- **数据处理**: Pandas, NumPy
- **数据源**: Baostock（免费开源证券数据平台）
- **数据存储**: SQLite3

## 项目结构

```
pe/
├── main.py                 # 程序入口
├── gui.py                  # 图形用户界面
├── data_fetcher.py         # 数据获取模块
├── database.py             # 数据库操作模块
├── valuation_calculator.py # 估值计算模块
├── chart_view.py           # 图表展示模块
├── font_config.py          # 字体配置模块
├── config.py               # 全局配置
├── requirements.txt        # 依赖包列表
├── stock_data.db           # SQLite 数据库文件
└── Doc/                    # 文档目录
    ├── README.md           # 项目说明文档
    ├── FEATURES.md         # 功能文档
    └── REQUIREMENTS.md     # 需求文档
```

## 核心功能

### 1. 股票数据查询
- 支持输入股票代码查询（自动识别沪市、深市、北交所）
- 支持日期范围选择
- 从 Baostock 获取历史 K 线数据

### 2. PE/PB 百分位计算
- 基于指定日期范围内的数据计算百分位
- 支持 PE（市盈率）和 PB（市净率）两种估值指标
- 百分位计算公式：`(范围内比当前值小的数量) / (范围内总数 - 1) * 100`

### 3. 数据可视化
- 使用 Matplotlib 绘制估值走势图
- 显示 PE/PB 百分位曲线
- 支持鼠标悬停查看详细数据
- 支持滑动条选择显示起始日期

### 4. 数据缓存
- 使用 SQLite 本地存储股票数据
- 避免重复下载，提高查询速度
- 支持手动刷新数据

### 5. 股票记忆功能
- 自动保存查询过的股票代码
- 下拉框快速选择历史股票
- 显示股票中文名称

### 6. 中文支持
- 自动配置中文字体
- 支持 Windows、Linux、macOS 系统

## 使用说明

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python main.py
```

### 基本操作
1. 输入股票代码（如 `sh.600519` 或 `600519`）
2. 选择开始日期和结束日期
3. 选择估值类型（PE 或 PB）
4. 点击"查询"按钮
5. 查看图表和估值信息

## 配置说明

### 时间范围
- 默认查询 10 年历史数据
- 支持自定义日期范围

### 估值阈值
- 低估阈值：30%（百分位 < 30% 显示为低估）
- 高估阈值：70%（百分位 > 70% 显示为高估）

## 更新日志

### v1.0.0 (2026-02-03)
- 初始版本发布
- 实现基础 PE/PB 百分位计算功能
- 支持数据缓存和股票记忆
- 支持中文显示

## 注意事项

1. 首次查询某只股票时，需要下载历史数据，可能需要等待几秒钟
2. 数据来源于 Baostock，需要网络连接
3. 本地缓存数据存储在 `stock_data.db` 文件中
4. 如需更新数据，请点击"刷新数据"按钮

## 许可证

本项目仅供学习和研究使用。
